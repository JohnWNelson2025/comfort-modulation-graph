<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NNMC Proof of Concept Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
  <style>
    body.light-mode { background-color: #f4f4f4; color: #000; }
    body.dark-mode { background-color: #121212; color: #fff; }
    #chartContainer { max-width: 900px; margin: auto; padding: 20px; }
    canvas { width: 100%; height: 500px; background-color: transparent; display: block; }
    #themeToggle { margin-bottom: 20px; padding: 10px 20px; font-size: 14px; cursor: pointer; border-radius: 6px; border: none; background-color: #2196F3; color: white; }
    .description { max-width: 900px; margin: 30px auto; font-size: 16px; line-height: 1.6; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    body.light-mode .description { background-color: #fff; color: #000; }
    body.dark-mode .description { background-color: #1e1e1e; color: #fff; }
    select { margin-bottom: 20px; padding: 10px; font-size: 14px; border-radius: 6px; }
  </style>
</head>
<body class="light-mode">
  <div class="description">
    <strong>Proof of Concept:</strong><br>
    This dashboard demonstrates NNMC with a country toggle, reflecting HIC/LMIC context using MCP. Hypothetical data shows AI’s role in contextual modeling.
  </div>

  <div id="chartContainer">
    <select id="countrySelect" onchange="updateChart()">
      <option value="usa">USA (HIC)</option>
      <option value="albania">Albania (LMIC)</option>
    </select>
    <button id="themeToggle">Toggle Background</button>
    <canvas id="comfortChart"></canvas>
  </div>

  <div class="description">
    <strong>Interpretive Summary:</strong><br>
    Toggle shows how resources (e.g., staffing, tech) impact tokens. HICs enhance trust; LMICs amplify worry.
  </div>
  
  <div style="margin-top: 20px; text-align: center;">
  <a href="https://johnwnelson2025.github.io/comfort-modulation-graph/" style="color: #2196F3; text-decoration: underline;">Back to Main Dashboard</a>
</div>

  <script>
    Chart.register(ChartDataLabels);

    function getLabelColor() {
      return document.body.classList.contains('dark-mode') ? '#fff' : '#000';
    }

    const ctx = document.getElementById('comfortChart').getContext('2d');
    let comfortChart = new Chart(ctx, {
      type: 'bubble',
      data: {
        datasets: []
      },
      options: {
        animation: { duration: 2000 },
        layout: { padding: { top: 20, bottom: 20, left: 20, right: 20 } },
        plugins: {
          datalabels: { align: 'center', anchor: 'center', color: getLabelColor, font: { weight: 'bold', size: 12 }, formatter: value => value.label },
          tooltip: { callbacks: { label: context => `${context.raw.label} → ${context.raw.quadrant}` } },
          legend: { position: 'top', labels: { boxWidth: 20, padding: 15 } }
        },
        scales: {
          x: { title: { display: true, text: 'Influence Axis', color: 'inherit' }, min: -12, max: 12, ticks: { color: 'inherit' }, grid: { color: 'rgba(200,200,200,0.2)' } },
          y: { title: { display: true, text: 'Impact Axis', color: 'inherit' }, min: -12, max: 12, ticks: { color: 'inherit' }, grid: { color: 'rgba(200,200,200,0.2)' } }
        }
      }
    });

    function updateChart() {
      const country = document.getElementById('countrySelect').value;
      const data = {
        usa: [
          { label: 'Core Hunch', color: '#4CAF50', border: '#388E3C', data: [{ x: 0, y: 0, r: 20, label: 'Comfort Theory', quadrant: 'Core Concept' }] },
          { label: 'Internal Predictors', color: '#F44336', border: '#D32F2F', data: [{ x: -10, y: 10, r: 12, label: 'Worry', quadrant: 'Disruptive Internal Predictor' }, { x: -9, y: 9, r: 10, label: 'Helplessness', quadrant: 'Disruptive Internal Predictor' }] },
          { label: 'External Predictors', color: '#2196F3', border: '#1976D2', data: [{ x: 10, y: 10, r: 15, label: 'Trust', quadrant: 'Supportive External Predictor' }, { x: 9, y: 9, r: 12, label: 'Env. Support', quadrant: 'Supportive External Predictor' }] },
          { label: 'Modulators', color: '#9C27B0', border: '#7B1FA2', data: [{ x: -5, y: -10, r: 10, label: 'Attention', quadrant: 'Subtle Modulator' }, { x: -6, y: -9, r: 10, label: 'Emotion', quadrant: 'Subtle Modulator' }] },
          { label: 'Outcomes', color: '#FF9800', border: '#F57C00', data: [{ x: 5, y: -10, r: 12, label: 'Relief', quadrant: 'Positive Outcome' }, { x: 6, y: -9, r: 10, label: 'Improved Exp.', quadrant: 'Positive Outcome' }] }
        ],
        albania: [
          { label: 'Core Hunch', color: '#4CAF50', border: '#388E3C', data: [{ x: 0, y: 0, r: 18, label: 'Comfort Theory', quadrant: 'Core Concept' }] },
          { label: 'Internal Predictors', color: '#F44336', border: '#D32F2F', data: [{ x: -11, y: 11, r: 15, label: 'Worry', quadrant: 'Disruptive Internal Predictor' }, { x: -10, y: 10, r: 13, label: 'Helplessness', quadrant: 'Disruptive Internal Predictor' }] },
          { label: 'External Predictors', color: '#2196F3', border: '#1976D2', data: [{ x: 8, y: 8, r: 12, label: 'Trust', quadrant: 'Supportive External Predictor' }, { x: 7, y: 7, r: 10, label: 'Env. Support', quadrant: 'Supportive External Predictor' }] },
          { label: 'Modulators', color: '#9C27B0', border: '#7B1FA2', data: [{ x: -6, y: -11, r: 10, label: 'Attention', quadrant: 'Subtle Modulator' }, { x: -7, y: -10, r: 10, label: 'Emotion', quadrant: 'Subtle Modulator' }] },
          { label: 'Outcomes', color: '#FF9800', border: '#F57C00', data: [{ x: 4, y: -11, r: 10, label: 'Relief', quadrant: 'Positive Outcome' }, { x: 5, y: -10, r: 9, label: 'Improved Exp.', quadrant: 'Positive Outcome' }] }
        ]
      }[country];

      comfortChart.data.datasets = data.map(d => ({ ...d, backgroundColor: d.color, borderColor: d.border, data: d.data }));
      comfortChart.update();
    }

    const toggleButton = document.getElementById('themeToggle');

    function updateCanvasBackground() {
      const canvas = document.getElementById('comfortChart');
      const isDark = document.body.classList.contains('dark-mode');
      canvas.style.backgroundColor = isDark ? '#000' : '#fff';
    }

    // Initial setup
    updateCanvasBackground();
    updateChart(); // Load USA data by default

    // Toggle theme and update canvas background
    toggleButton.addEventListener('click', () => {
      document.body.classList.toggle('light-mode');
      document.body.classList.toggle('dark-mode');
      updateCanvasBackground();
      comfortChart.options.plugins.datalabels.color = getLabelColor;
      comfortChart.update();
    });
  </script>
</body>
</html>